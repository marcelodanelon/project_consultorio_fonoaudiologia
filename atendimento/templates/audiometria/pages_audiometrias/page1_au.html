<div class="row align-items-center">
    <div class="col">                 
        <label for="{{ field.id_for_label }}" class="form-label">{{form.aClient.label}}</label>
        <div class="input-group">
            <div style="width: 300px !important;">
                <input type="text" class="form-control" placeholder="Digite um nome" id="input_aClient" name="input_aClient">
            </div>
            {{form.aClient}}
            <div class="input-group-append">
                <button id="searchButtonCliente" class="btn btn-outline-secondary" type="button" title="Buscar">ðŸ”Ž</button>
            </div>
            <div class="input-group-append">
                <button id="newSearchButtonCliente" class="btn btn-outline-secondary" type="button" title="Nova Busca">ðŸª„</button>
            </div>
        </div>
    </div> 
</div>
<div class="row align-items-center">
    <div class="col">
        {{form.auData.label}}{{form.auData}}
    </div>
    <div class="col">
        {{form.auProfessional.label}}{{form.auProfessional}}
    </div>
    <div class="col">
        {{form.auLocal.label}}{{form.auLocal}}
    </div>
</div>
<div class="row align-items-center">
    <div class="col">
        {{form.auAudio.label}}{{form.auAudio}}
    </div>
    <div class="col">
        {{form.auCalib.label}}{{form.auCalib}}
    </div>
    <div class="col">
        {{form.auMedSo.label}}{{form.auMedSo}}
    </div>
</div>
<br>
<div class="row align-items-center">
    <div class="col-6" style="display: flex; flex-direction: column; align-items: center; justify-content: center;">
        <b>Ouvido Esquerdo</b><br>
        <div class="cartesian-plane" id="cartesian-plane">
            <!-- Eixo X -->
            <div class="axis x-axis"></div>
    
            <!-- Eixo Y -->
            <div class="axis y-axis"></div>
    
            <!-- Ticks no eixo X -->
            <!-- Criei 10 ticks igualmente espaÃ§ados -->
            <div class="tick x-tick" style="left: 0%;">
                <div class="x-label" style="position: absolute; font-size: 12px; transform: translateX(-50%); top: -20px;"></div>
            </div>
            <div class="tick x-tick" style="left: 10%;">
                <div class="x-label" style="position: absolute; font-size: 12px; transform: translateX(-50%); top: -20px;">250</div>
            </div>
            <div class="tick x-tick" style="left: 20%;">
                <div class="x-label" style="position: absolute; font-size: 12px; transform: translateX(-50%); top: -20px;">500</div>
            </div>
            <div class="tick x-tick" style="left: 30%;">
                <div class="x-label" style="position: absolute; font-size: 12px; transform: translateX(-50%); top: -20px;">1K</div>
            </div>
            <div class="tick x-tick" style="left: 40%;">
                <div class="x-label" style="position: absolute; font-size: 12px; transform: translateX(-50%); top: -20px;">2K</div>
            </div>
            <div class="tick x-tick" style="left: 50%;">
                <div class="x-label" style="position: absolute; font-size: 12px; transform: translateX(-50%); top: -20px;">3K</div>
            </div>
            <div class="tick x-tick" style="left: 60%;">
                <div class="x-label" style="position: absolute; font-size: 12px; transform: translateX(-50%); top: -20px;">4K</div>
            </div>
            <div class="tick x-tick" style="left: 70%;">
                <div class="x-label" style="position: absolute; font-size: 12px; transform: translateX(-50%); top: -20px;">6K</div>
            </div>
            <div class="tick x-tick" style="left: 80%;">
                <div class="x-label" style="position: absolute; font-size: 12px; transform: translateX(-50%); top: -20px;">8K</div>
            </div>
            <div class="tick x-tick" style="left: 100%;">
                <div class="x-label" style="position: absolute; font-size: 12px; transform: translateX(-50%); top: -20px;">Hz</div>
            </div>
    
            <!-- Ticks no eixo Y -->
            <!-- Criei 10 ticks igualmente espaÃ§ados -->
            <div class="tick y-tick" style="top: 0%;">
                <div class="x-label" style="position: absolute; font-size: 12px; transform: translateY(-50%); left: -23px;">-10</div>
            </div>
            <div class="tick y-tick" style="top: 10%;">
                <div class="x-label" style="position: absolute; font-size: 12px; transform: translateY(-50%); left: -23px;">0</div>
            </div>
            <div class="tick y-tick" style="top: 20%;">
                <div class="x-label" style="position: absolute; font-size: 12px; transform: translateY(-50%); left: -23px;">10</div>
            </div>
            <div class="tick y-tick" style="top: 30%;">
                <div class="x-label" style="position: absolute; font-size: 12px; transform: translateY(-50%); left: -23px;">20</div>
            </div>
            <div class="tick y-tick" style="top: 40%;">
                <div class="x-label" style="position: absolute; font-size: 12px; transform: translateY(-50%); left: -23px;">30</div>
            </div>
            <div class="tick y-tick" style="top: 50%;">
                <div class="x-label" style="position: absolute; font-size: 12px; transform: translateY(-50%); left: -23px;">40</div>
            </div>
            <div class="tick y-tick" style="top: 60%;">
                <div class="x-label" style="position: absolute; font-size: 12px; transform: translateY(-50%); left: -23px;">50</div>
            </div>
            <div class="tick y-tick" style="top: 70%;">
                <div class="x-label" style="position: absolute; font-size: 12px; transform: translateY(-50%); left: -23px;">60</div>
            </div>
            <div class="tick y-tick" style="top: 80%;">
                <div class="x-label" style="position: absolute; font-size: 12px; transform: translateY(-50%); left: -23px;">70</div>
            </div>
            <div class="tick y-tick" style="top: 90%;">
                <div class="x-label" style="position: absolute; font-size: 12px; transform: translateY(-50%); left: -23px;">80</div>
            </div>
            <div class="tick y-tick" style="top: 100%;">
                <div class="x-label" style="position: absolute; font-size: 12px; transform: translateY(-50%); left: -23px;">90</div>
            </div>
            <div class="tick y-tick" style="top: 110%;">
                <div class="x-label" style="position: absolute; font-size: 12px; transform: translateY(-50%); left: -23px;">100</div>
            </div>
            <div class="tick y-tick" style="top: 120%;">
                <div class="x-label" style="position: absolute; font-size: 12px; transform: translateY(-50%); left: -23px;">110</div>
            </div>            
        </div>
    </div>

    <div class="col-6" style="display: flex; flex-direction: column; align-items: center; justify-content: center;">
        <b>Ouvido Direito</b><br>
        <div class="cartesian-plane" id="cartesian-plane2">
            <!-- Eixo X -->
            <div class="axis x-axis"></div>
    
            <!-- Eixo Y -->
            <div class="axis y-axis"></div>
    
            <!-- Ticks no eixo X -->
            <!-- Criei 10 ticks igualmente espaÃ§ados -->
            <div class="tick x-tick" style="left: 0%;">
                <div class="x-label" style="position: absolute; font-size: 12px; transform: translateX(-50%); top: -20px;"></div>
            </div>
            <div class="tick x-tick" style="left: 10%;">
                <div class="x-label" style="position: absolute; font-size: 12px; transform: translateX(-50%); top: -20px;">250</div>
            </div>
            <div class="tick x-tick" style="left: 20%;">
                <div class="x-label" style="position: absolute; font-size: 12px; transform: translateX(-50%); top: -20px;">500</div>
            </div>
            <div class="tick x-tick" style="left: 30%;">
                <div class="x-label" style="position: absolute; font-size: 12px; transform: translateX(-50%); top: -20px;">1K</div>
            </div>
            <div class="tick x-tick" style="left: 40%;">
                <div class="x-label" style="position: absolute; font-size: 12px; transform: translateX(-50%); top: -20px;">2K</div>
            </div>
            <div class="tick x-tick" style="left: 50%;">
                <div class="x-label" style="position: absolute; font-size: 12px; transform: translateX(-50%); top: -20px;">3K</div>
            </div>
            <div class="tick x-tick" style="left: 60%;">
                <div class="x-label" style="position: absolute; font-size: 12px; transform: translateX(-50%); top: -20px;">4K</div>
            </div>
            <div class="tick x-tick" style="left: 70%;">
                <div class="x-label" style="position: absolute; font-size: 12px; transform: translateX(-50%); top: -20px;">6K</div>
            </div>
            <div class="tick x-tick" style="left: 80%;">
                <div class="x-label" style="position: absolute; font-size: 12px; transform: translateX(-50%); top: -20px;">8K</div>
            </div>
            <div class="tick x-tick" style="left: 100%;">
                <div class="x-label" style="position: absolute; font-size: 12px; transform: translateX(-50%); top: -20px;">Hz</div>
            </div>
    
            <!-- Ticks no eixo Y -->
            <!-- Criei 10 ticks igualmente espaÃ§ados -->
            <div class="tick y-tick" style="top: 0%;">
                <div class="x-label" style="position: absolute; font-size: 12px; transform: translateY(-50%); left: -23px;">-10</div>
            </div>
            <div class="tick y-tick" style="top: 10%;">
                <div class="x-label" style="position: absolute; font-size: 12px; transform: translateY(-50%); left: -23px;">0</div>
            </div>
            <div class="tick y-tick" style="top: 20%;">
                <div class="x-label" style="position: absolute; font-size: 12px; transform: translateY(-50%); left: -23px;">10</div>
            </div>
            <div class="tick y-tick" style="top: 30%;">
                <div class="x-label" style="position: absolute; font-size: 12px; transform: translateY(-50%); left: -23px;">20</div>
            </div>
            <div class="tick y-tick" style="top: 40%;">
                <div class="x-label" style="position: absolute; font-size: 12px; transform: translateY(-50%); left: -23px;">30</div>
            </div>
            <div class="tick y-tick" style="top: 50%;">
                <div class="x-label" style="position: absolute; font-size: 12px; transform: translateY(-50%); left: -23px;">40</div>
            </div>
            <div class="tick y-tick" style="top: 60%;">
                <div class="x-label" style="position: absolute; font-size: 12px; transform: translateY(-50%); left: -23px;">50</div>
            </div>
            <div class="tick y-tick" style="top: 70%;">
                <div class="x-label" style="position: absolute; font-size: 12px; transform: translateY(-50%); left: -23px;">60</div>
            </div>
            <div class="tick y-tick" style="top: 80%;">
                <div class="x-label" style="position: absolute; font-size: 12px; transform: translateY(-50%); left: -23px;">70</div>
            </div>
            <div class="tick y-tick" style="top: 90%;">
                <div class="x-label" style="position: absolute; font-size: 12px; transform: translateY(-50%); left: -23px;">80</div>
            </div>
            <div class="tick y-tick" style="top: 100%;">
                <div class="x-label" style="position: absolute; font-size: 12px; transform: translateY(-50%); left: -23px;">90</div>
            </div>
            <div class="tick y-tick" style="top: 110%;">
                <div class="x-label" style="position: absolute; font-size: 12px; transform: translateY(-50%); left: -23px;">100</div>
            </div>
            <div class="tick y-tick" style="top: 120%;">
                <div class="x-label" style="position: absolute; font-size: 12px; transform: translateY(-50%); left: -23px;">110</div>
            </div>            
        </div>
    </div>    
</div>
<script>
document.addEventListener("DOMContentLoaded", function () {
    const plane = document.getElementById("cartesian-plane");
    let greenPoints = [];
    let bluePoints = [];
    let selectedLineType = 1;

    for (let i = 0; i <= 100; i += 10) {
        for (let j = 0; j <= 120; j += 10) {
            if (i != 90){
                const point = document.createElement("div");
                point.className = "intersection-point";
                point.style.left = i + "%";
                point.style.top = j + "%";
                plane.appendChild(point);
            }
        }
    }

    plane.addEventListener("click", function (event) {
        const clickedPoint = document.elementFromPoint(event.clientX, event.clientY);

        if (clickedPoint && clickedPoint.classList.contains("intersection-point")) {
            // Adiciona um ponto verde ou azul, dependendo do botÃ£o selecionado
            const point = document.createElement("div");
            point.className = selectedLineType === 1 ? "green-point" : "blue-point";
            point.style.left = clickedPoint.style.left;
            point.style.top = clickedPoint.style.top;
            plane.appendChild(point);

            // Adiciona o ponto Ã  lista correspondente
            if (selectedLineType === 1) {
                greenPoints.push(point);
            } else if (selectedLineType === 2) {
                bluePoints.push(point);
            }

            // Conecta pontos com uma linha
            if (greenPoints.length > 1 && selectedLineType === 1) {
                const line = createLineElement("line-green");
                connectPointsWithLine(greenPoints[greenPoints.length - 2], point, line, plane);
            }
            if (bluePoints.length > 1 && selectedLineType === 2) {
                const line = createLineElement("line-blue");
                connectPointsWithLine(bluePoints[bluePoints.length - 2], point, line, plane);
            }
        }
    });

    window.selectLineType = function(type) {
        // Atualiza o tipo de linha selecionado
        selectedLineType = type;
    }

    window.clearAll = function() {
        // Limpa todos os pontos e linhas
        greenPoints.forEach(point => plane.removeChild(point));
        bluePoints.forEach(point => plane.removeChild(point));
        greenPoints = [];
        bluePoints = [];
        const lines = document.querySelectorAll(".line");
        lines.forEach(line => plane.removeChild(line));
    }
});

function connectPointsWithLine(point1, point2, line, plane) {
    const startX = parseFloat(point1.style.left);
    const startY = parseFloat(point1.style.top);
    const endX = parseFloat(point2.style.left);
    const endY = parseFloat(point2.style.top);

    // Calcula o comprimento e Ã¢ngulo em porcentagens
    const length = Math.sqrt(Math.pow(endX - startX, 2) + Math.pow(endY - startY, 2));
    const angle = Math.atan2(endY - startY, endX - startX);

    // Define as coordenadas do ponto inicial e o comprimento da linha
    line.style.left = startX + "%";
    line.style.top = startY + "%";
    line.style.width = length + "%";

    // Define a transformaÃ§Ã£o para a rotaÃ§Ã£o da linha
    line.style.transform = `rotate(${angle}rad)`;

    // Adiciona a linha Ã  tela
    plane.appendChild(line);
}

function createLineElement(className) {
    const line = document.createElement("div");
    line.className = "line " + className;
    return line;
}
</script>
